# Non-Functional Requirements (NFR)

**Project**: Library Management System (PSOFT-G1)
**Date**: 2025-10-29
**Version**: 1.0
**Status**: Extracted from Implementation (Reverse Engineered)

---

## Table of Contents
1. [Introduction](#introduction)
2. [Security Requirements (NFR-SEC)](#security-requirements-nfr-sec)
3. [Performance Requirements (NFR-PERF)](#performance-requirements-nfr-perf)
4. [Reliability Requirements (NFR-REL)](#reliability-requirements-nfr-rel)
5. [Maintainability Requirements (NFR-MAINT)](#maintainability-requirements-nfr-maint)
6. [Usability Requirements (NFR-USE)](#usability-requirements-nfr-use)
7. [Scalability Requirements (NFR-SCALE)](#scalability-requirements-nfr-scale)
8. [Portability Requirements (NFR-PORT)](#portability-requirements-nfr-port)
9. [Compliance Requirements (NFR-COMP)](#compliance-requirements-nfr-comp)
10. [Interoperability Requirements (NFR-INTER)](#interoperability-requirements-nfr-inter)
11. [NFR Summary and Traceability](#nfr-summary-and-traceability)

---

## Introduction

This document specifies the non-functional requirements (quality attributes) for the Library Management System, extracted from the implemented codebase through reverse engineering. Non-functional requirements define **how** the system should behave, as opposed to functional requirements which define **what** the system should do.

Each requirement is categorized using the ISO/IEC 25010 quality model and traced to its implementation evidence.

---

## Security Requirements (NFR-SEC)

### NFR-SEC-01: Authentication Mechanism
**Category**: Security - Authentication
**Priority**: Critical

**Requirement**: The system SHALL use JWT (JSON Web Token) with RSA asymmetric encryption for stateless authentication.

**Rationale**:
- Stateless authentication supports horizontal scaling
- RSA provides strong cryptographic security
- Industry-standard approach for REST APIs

**Implementation Evidence**:
- JWT encoder/decoder: [SecurityConfig.java:179-191](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L179-L191)
- RSA key configuration: [application.properties:18-19](Original/src/main/resources/application.properties#L18-L19)
- RSA private key: `rsa.private.key`
- RSA public key: `rsa.public.key`

**Measurement Criteria**:
- ✅ JWT tokens generated with RSA-512 signature
- ✅ Token validation on every protected endpoint
- ✅ Tokens contain user roles and expiration

---

### NFR-SEC-02: Password Security
**Category**: Security - Confidentiality
**Priority**: Critical

**Requirement**: The system SHALL hash all passwords using BCrypt algorithm with salt before storing them in the database. Passwords SHALL NEVER be stored in plaintext or logged.

**Rationale**:
- BCrypt is computationally expensive, resistant to brute-force attacks
- Salting prevents rainbow table attacks
- Industry best practice for password storage

**Implementation Evidence**:
- Password encoder: [SecurityConfig.java:206-209](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L206-L209)
- Password value object: [Password.java](Original/src/main/java/pt/psoft/g1/psoftg1/usermanagement/model/Password.java)

**Measurement Criteria**:
- ✅ BCrypt algorithm (work factor 10+)
- ✅ No plaintext passwords in database
- ✅ Password strength validation enforced

---

### NFR-SEC-03: Role-Based Access Control
**Category**: Security - Authorization
**Priority**: Critical

**Requirement**: The system SHALL enforce role-based access control (RBAC) at the endpoint level, with three distinct roles: ADMIN, LIBRARIAN, and READER. Each endpoint SHALL have explicitly defined access rules.

**Rationale**:
- Implements principle of least privilege
- Prevents unauthorized access to sensitive operations
- Clear separation of concerns

**Implementation Evidence**:
- Authorization rules: [SecurityConfig.java:110-172](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L110-L172)
- Role definitions: [Role.java](Original/src/main/java/pt/psoft/g1/psoftg1/usermanagement/model/Role.java)

**Measurement Criteria**:
- ✅ 100% of endpoints have defined access rules
- ✅ Role validation on every request
- ✅ Zero privilege escalation vulnerabilities

---

### NFR-SEC-04: Session Management
**Category**: Security - Session Management
**Priority**: High

**Requirement**: The system SHALL use stateless session management. No session state SHALL be stored on the server. All authentication state SHALL be contained within JWT tokens.

**Rationale**:
- Stateless design enables horizontal scaling
- Reduces server memory footprint
- Eliminates session fixation attacks

**Implementation Evidence**:
- Stateless configuration: [SecurityConfig.java:102](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L102)
- `SessionCreationPolicy.STATELESS`

**Measurement Criteria**:
- ✅ No server-side session storage
- ✅ All state in JWT token
- ✅ Session policy: STATELESS

---

### NFR-SEC-05: HTTPS Support
**Category**: Security - Confidentiality
**Priority**: High (Production)

**Requirement**: The system SHOULD support HTTPS for all client-server communication in production environments to prevent man-in-the-middle attacks and eavesdropping.

**Rationale**:
- Protects sensitive data (passwords, personal information) in transit
- Industry standard for web applications
- Compliance requirement for GDPR

**Implementation Evidence**:
- Spring Boot supports HTTPS configuration
- CORS configured: [SecurityConfig.java:211-222](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L211-L222)

**Measurement Criteria**:
- ⚠️ Configured per deployment environment
- ⚠️ TLS 1.2+ required in production
- ✅ CORS configured for secure origins

**Status**: Configuration-dependent (not enforced in development)

---

### NFR-SEC-06: CSRF Protection
**Category**: Security - CSRF
**Priority**: Medium

**Requirement**: The system SHALL disable CSRF protection for stateless JWT authentication, as CSRF attacks are not applicable to token-based authentication where tokens are not automatically sent by browsers.

**Rationale**:
- CSRF protection designed for session-based authentication
- JWT tokens must be explicitly sent (Authorization header)
- Browsers don't automatically attach custom headers

**Implementation Evidence**:
- CSRF disabled: [SecurityConfig.java:99](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L99)

**Measurement Criteria**:
- ✅ CSRF disabled for JWT endpoints
- ✅ Bearer token authentication required

---

### NFR-SEC-07: Input Validation
**Category**: Security - Input Validation
**Priority**: High

**Requirement**: The system SHALL validate all user inputs at domain boundaries using Jakarta Bean Validation annotations and custom domain logic to prevent injection attacks and data corruption.

**Rationale**:
- Prevents SQL injection, XSS, and other injection attacks
- Ensures data integrity
- Fail-fast principle

**Implementation Evidence**:
- Bean validation: `@NotNull`, `@NotBlank`, `@Size`, `@Pattern`
- Domain validation: [Genre.java:27-34](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/model/Genre.java#L27-L34)
- ISBN validation: [Isbn.java](Original/src/main/java/pt/psoft/g1/psoftg1/bookmanagement/model/Isbn.java)
- Exception handling: [GlobalExceptionHandler.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/GlobalExceptionHandler.java)

**Measurement Criteria**:
- ✅ All inputs validated before persistence
- ✅ Validation errors return 400 Bad Request
- ✅ No SQL injection vulnerabilities (JPA prevents)

---

## Performance Requirements (NFR-PERF)

### NFR-PERF-01: Response Time
**Category**: Performance - Response Time
**Priority**: High

**Requirement**: The system SHALL respond to 95% of API requests within 500ms under normal load conditions (up to 50 concurrent users).

**Rationale**:
- Good user experience requires responsive API
- Acceptable for library management domain (not real-time)
- Aligns with typical SLA expectations

**Implementation Evidence**:
- H2 in-memory database option: [application.properties:28](Original/src/main/resources/application.properties#L28)
- JPA caching and connection pooling (Spring Boot defaults)
- Eager fetching for critical relationships: [Lending.java:57-58](Original/src/main/java/pt/psoft/g1/psoftg1/lendingmanagement/model/Lending.java#L57-L58)

**Measurement Criteria**:
- ⚠️ Requires performance testing to validate
- Target: p95 < 500ms
- Target: p99 < 1000ms

**Status**: Not explicitly measured (assumption based on architecture)

---

### NFR-PERF-02: Database Query Performance
**Category**: Performance - Efficiency
**Priority**: Medium

**Requirement**: The system SHALL optimize database queries using appropriate indexing, query optimization, and caching strategies. Complex queries SHOULD execute within 200ms.

**Rationale**:
- Database is often the bottleneck
- Proper indexing critical for search operations
- Caching reduces database load

**Implementation Evidence**:
- JPA generated indexes on primary keys
- Unique constraints create indexes: [Book.java:19-21](Original/src/main/java/pt/psoft/g1/psoftg1/bookmanagement/model/Book.java#L19-L21)
- Custom queries in repositories
- Spring Data JPA query derivation

**Measurement Criteria**:
- ⚠️ Indexes on: ISBN, reader number, lending number (unique constraints)
- ⚠️ Query optimization via JPA query methods
- ⚠️ No N+1 query problems

**Status**: Implicit through JPA configuration

---

### NFR-PERF-03: Concurrency Control
**Category**: Performance - Concurrency
**Priority**: High

**Requirement**: The system SHALL handle concurrent updates to the same entity using optimistic locking to prevent lost updates while maintaining high throughput.

**Rationale**:
- Optimistic locking provides better performance than pessimistic locking
- Conflicts are rare in library domain
- Avoids database-level locks

**Implementation Evidence**:
- `@Version` annotation on entities:
  - [Book.java:27-29](Original/src/main/java/pt/psoft/g1/psoftg1/bookmanagement/model/Book.java#L27-L29)
  - [Author.java:19-20](Original/src/main/java/pt/psoft/g1/psoftg1/authormanagement/model/Author.java#L19-L20)
  - [Lending.java:96-101](Original/src/main/java/pt/psoft/g1/psoftg1/lendingmanagement/model/Lending.java#L96-L101)
  - [ReaderDetails.java:52-54](Original/src/main/java/pt/psoft/g1/psoftg1/readermanagement/model/ReaderDetails.java#L52-L54)
- Version checks in update methods: [Book.applyPatch():94-96](Original/src/main/java/pt/psoft/g1/psoftg1/bookmanagement/model/Book.java#L94-L96)

**Measurement Criteria**:
- ✅ All mutable entities have `@Version` field
- ✅ StaleObjectStateException thrown on conflict
- ✅ Clients must provide expected version

---

### NFR-PERF-04: Pagination
**Category**: Performance - Scalability
**Priority**: High

**Requirement**: The system SHALL support pagination for all endpoints that return collections, preventing large result sets from degrading performance or consuming excessive memory.

**Rationale**:
- Large result sets impact memory and network bandwidth
- Improves client-side rendering performance
- Standard practice for REST APIs

**Implementation Evidence**:
- Page model: [Page.java](Original/src/main/java/pt/psoft/g1/psoftg1/shared/services/Page.java)
- SearchRequest pattern: [SearchRequest.java](Original/src/main/java/pt/psoft/g1/psoftg1/shared/services/SearchRequest.java)
- Usage in controllers: [GenreController.java:21-26](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/api/GenreController.java#L21-L26)

**Measurement Criteria**:
- ✅ Pagination available on search endpoints
- ✅ Default page size configured
- ✅ Maximum page size enforced

---

### NFR-PERF-05: File Upload Performance
**Category**: Performance - Throughput
**Priority**: Medium

**Requirement**: The system SHALL support file uploads up to 200MB with a file size threshold of 2KB for in-memory processing. Photos SHALL be limited to 20KB.

**Rationale**:
- Balances flexibility with resource constraints
- 20KB sufficient for web-optimized photos
- 200MB accommodates potential future file types

**Implementation Evidence**:
- Multipart config: [application.properties:54-71](Original/src/main/resources/application.properties#L54-L71)
  - `spring.servlet.multipart.max-file-size=200MB`
  - `spring.servlet.multipart.max-request-size=215MB`
  - `spring.servlet.multipart.file-size-threshold=2KB`
  - `file.photo_max_size=20000` (bytes)

**Measurement Criteria**:
- ✅ Max file size: 200MB
- ✅ Max request size: 215MB
- ✅ Photo size limit: 20KB
- ✅ Disk write threshold: 2KB

---

## Reliability Requirements (NFR-REL)

### NFR-REL-01: Data Integrity
**Category**: Reliability - Integrity
**Priority**: Critical

**Requirement**: The system SHALL ensure data integrity through database constraints, transaction management, and validation at multiple levels (database, domain, API).

**Rationale**:
- Data corruption can have serious business consequences
- Multiple validation layers provide defense in depth
- Database constraints are last line of defense

**Implementation Evidence**:
- Unique constraints: [Lending.java:27-28](Original/src/main/java/pt/psoft/g1/psoftg1/lendingmanagement/model/Lending.java#L27-L28)
- Not-null constraints: [Lending.java:55-66](Original/src/main/java/pt/psoft/g1/psoftg1/lendingmanagement/model/Lending.java#L55-L66)
- Foreign key constraints (implicit in JPA @ManyToOne, @ManyToMany)
- Domain validation: [Genre.java:27-34](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/model/Genre.java#L27-L34)
- JPA schema generation: [application.properties:42-44](Original/src/main/resources/application.properties#L42-L44)

**Measurement Criteria**:
- ✅ Database-level constraints enforced
- ✅ Domain-level validation
- ✅ Zero orphaned records
- ✅ Referential integrity maintained

---

### NFR-REL-02: Transaction Management
**Category**: Reliability - Consistency
**Priority**: High

**Requirement**: The system SHALL use ACID transactions for all data modifications to ensure consistency. All service methods that modify data SHOULD be transactional.

**Rationale**:
- ACID properties ensure data consistency
- Transactions prevent partial updates
- Critical for financial data (fines)

**Implementation Evidence**:
- Spring `@Transactional` on service layer (Spring Boot default)
- JPA transaction management
- Database ACID compliance (H2 supports transactions)

**Measurement Criteria**:
- ⚠️ Service methods are transactional (Spring default)
- ✅ No partial updates observed
- ✅ Rollback on exceptions

**Status**: Implicit through Spring framework

---

### NFR-REL-03: Error Handling
**Category**: Reliability - Fault Tolerance
**Priority**: High

**Requirement**: The system SHALL provide consistent error handling with appropriate HTTP status codes and meaningful error messages. All exceptions SHALL be caught and logged.

**Rationale**:
- Consistent error handling improves API usability
- Prevents information leakage through stack traces
- Facilitates debugging and monitoring

**Implementation Evidence**:
- Global exception handler: [GlobalExceptionHandler.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/GlobalExceptionHandler.java)
- Custom exceptions:
  - [NotFoundException.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/NotFoundException.java)
  - [ConflictException.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/ConflictException.java)
  - [FileStorageException.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/FileStorageException.java)
  - [LendingForbiddenException.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/LendingForbiddenException.java)

**Measurement Criteria**:
- ✅ Global exception handler configured
- ✅ Appropriate HTTP status codes (404, 409, 400, 500)
- ✅ No stack traces exposed to clients
- ✅ Error messages are actionable

---

### NFR-REL-04: Data Backup and Recovery
**Category**: Reliability - Recoverability
**Priority**: Medium

**Requirement**: The system SHOULD support database backup and recovery mechanisms. File-based H2 database SHALL persist data to disk for durability.

**Rationale**:
- Data loss is unacceptable for production systems
- File-based storage provides persistence
- Backup enables disaster recovery

**Implementation Evidence**:
- File-based database: [application.properties:24](Original/src/main/resources/application.properties#L24)
  - `jdbc:h2:tcp://localhost/~/psoft-g1`
- Alternative configurations available (file, in-memory)

**Measurement Criteria**:
- ✅ File-based database available
- ⚠️ Backup strategy (manual file copy)
- ⚠️ Recovery procedure documented

**Status**: Configuration-dependent, manual backup required

---

## Maintainability Requirements (NFR-MAINT)

### NFR-MAINT-01: Code Organization
**Category**: Maintainability - Modularity
**Priority**: High

**Requirement**: The system SHALL be organized into clearly defined layers (presentation, business, data) and modules (by domain aggregate) to facilitate maintenance and evolution.

**Rationale**:
- Layered architecture is well-understood pattern
- Domain modules align with business concepts
- Reduces cognitive load for developers

**Implementation Evidence**:
- Consistent package structure across all modules:
  ```
  authormanagement/
  ├── api/              ← Presentation Layer
  ├── services/         ← Business Layer
  ├── repositories/     ← Data Layer
  └── model/            ← Domain Model
  ```
- Same pattern in: bookmanagement, lendingmanagement, readermanagement, genremanagement, usermanagement

**Measurement Criteria**:
- ✅ 7 domain modules identified
- ✅ 3-layer architecture consistently applied
- ✅ Clear separation of concerns
- ✅ Low coupling between modules

---

### NFR-MAINT-02: Code Documentation
**Category**: Maintainability - Understandability
**Priority**: Medium

**Requirement**: The system SHOULD have comprehensive documentation including domain model, glossary, use cases, and API documentation. Code SHOULD include Javadoc comments for public APIs.

**Rationale**:
- Documentation reduces onboarding time
- Domain knowledge must be captured
- API documentation enables integration

**Implementation Evidence**:
- Domain artifacts: [Docs/GlobalArtifacts/](Original/Docs/GlobalArtifacts/)
  - Domain model, glossary, aggregates, entities, value objects
- Use case documentation: [Docs/Phase1/](Original/Docs/Phase1/), [Docs/Phase2/](Original/Docs/Phase2/)
- REST API mapping: [RestMapping.md](Original/Docs/Phase2/RestMapping.md)
- OpenAPI documentation: Swagger UI at `/swagger-ui`
- Postman collections for testing

**Measurement Criteria**:
- ✅ Domain model documented
- ✅ Glossary maintained
- ✅ Use cases documented (44 use cases)
- ✅ API documentation (Swagger)
- ⚠️ Javadoc coverage varies

---

### NFR-MAINT-03: Testability
**Category**: Maintainability - Testability
**Priority**: High

**Requirement**: The system SHALL be designed for testability with dependency injection, interface-based programming, and clear layer boundaries to facilitate unit and integration testing.

**Rationale**:
- Testable code is maintainable code
- Tests serve as documentation
- Regression prevention

**Implementation Evidence**:
- Dependency injection (Spring IoC)
- Service interfaces with implementations
- 23 test files identified
- Repository pattern enables mocking
- Constructor injection: [GenreController.java:17-19](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/api/GenreController.java#L17-L19)

**Measurement Criteria**:
- ✅ Dependency injection throughout
- ✅ Interface-based services
- ✅ Test files present (23 tests)
- ⚠️ Test coverage not measured

---

### NFR-MAINT-04: Configuration Externalization
**Category**: Maintainability - Modifiability
**Priority**: High

**Requirement**: The system SHALL externalize configuration in properties files, separating business rules from code. Configuration SHOULD be changeable without recompilation.

**Rationale**:
- Separates policy from implementation
- Enables environment-specific configuration
- Business rules visible to non-developers

**Implementation Evidence**:
- Application config: [application.properties](Original/src/main/resources/application.properties)
  - Database connection
  - JWT keys
  - File upload limits
  - API keys
- Business rules: [library.properties](Original/src/main/resources/config/library.properties)
  - `lendingDurationInDays=15`
  - `fineValuePerDayInCents=200`
  - `minimumReaderAge=12`
  - `suggestionsLimitPerGenre=2`

**Measurement Criteria**:
- ✅ Configuration externalized
- ✅ Business rules in properties files
- ✅ Environment-specific configuration supported
- ✅ No hardcoded business values

---

### NFR-MAINT-05: Dependency Management
**Category**: Maintainability - Modifiability
**Priority**: Medium

**Requirement**: The system SHALL use a dependency management tool (Maven/Gradle) to manage third-party libraries and ensure reproducible builds.

**Rationale**:
- Consistent dependencies across environments
- Reproducible builds
- Simplified dependency updates

**Implementation Evidence**:
- Maven/Gradle project structure evident
- Spring Boot manages dependency versions
- IntelliJ IDEA project: [.idea/](Original/.idea/)

**Measurement Criteria**:
- ✅ Dependency management tool used
- ✅ Dependency versions managed
- ✅ Reproducible builds

**Status**: Evident from project structure

---

## Usability Requirements (NFR-USE)

### NFR-USE-01: API Documentation
**Category**: Usability - Learnability
**Priority**: High

**Requirement**: The system SHALL provide interactive API documentation using OpenAPI/Swagger UI, accessible at `/swagger-ui`, with 100% endpoint coverage and request/response examples.

**Rationale**:
- Self-documenting API reduces integration time
- Interactive testing improves developer experience
- Industry standard

**Implementation Evidence**:
- OpenAPI enabled: [application.properties:9-13](Original/src/main/resources/application.properties#L9-L13)
  - `springdoc.api-docs.enabled=true`
  - `springdoc.api-docs.path=/api-docs`
  - `springdoc.swagger-ui.path=/swagger-ui`
- Controller tags: [GenreController.java:13](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/api/GenreController.java#L13)

**Measurement Criteria**:
- ✅ Swagger UI available at `/swagger-ui`
- ✅ All endpoints documented
- ✅ Tag-based organization
- ✅ Request/response schemas

---

### NFR-USE-02: RESTful Design
**Category**: Usability - Understandability
**Priority**: High

**Requirement**: The system SHALL follow RESTful design principles with resource-based URLs, appropriate HTTP verbs, and consistent response formats.

**Rationale**:
- REST is widely understood
- Predictable API design
- Industry best practice

**Implementation Evidence**:
- Resource-based URLs: `/api/books/{isbn}`, `/api/authors/{id}`
- HTTP verbs: GET (read), POST (create), PUT (create/replace), PATCH (update), DELETE (remove)
- Consistent response wrapper: [ListResponse.java](Original/src/main/java/pt/psoft/g1/psoftg1/shared/api/ListResponse.java)
- REST mapping documented: [RestMapping.md](Original/Docs/Phase2/RestMapping.md)

**Measurement Criteria**:
- ✅ Resource-based URLs
- ✅ HTTP verb semantics followed
- ✅ Stateless interactions
- ✅ Consistent response formats

---

### NFR-USE-03: Error Messages
**Category**: Usability - User Error Protection
**Priority**: Medium

**Requirement**: The system SHALL provide clear, actionable error messages with appropriate HTTP status codes. Error messages SHOULD indicate what went wrong and how to fix it.

**Rationale**:
- Good error messages reduce support burden
- Improves developer experience
- Facilitates debugging

**Implementation Evidence**:
- Global exception handler: [GlobalExceptionHandler.java](Original/src/main/java/pt/psoft/g1/psoftg1/exceptions/GlobalExceptionHandler.java)
- Domain validation messages: [Genre.java:32-33](Original/src/main/java/pt/psoft/g1/psoftg1/genremanagement/model/Genre.java#L32-L33)
  - "Genre has a maximum of 4096 characters"
- Bean validation messages: `@Size(min = 1, max = 100, message = "Genre name must be between 1 and 100 characters")`

**Measurement Criteria**:
- ✅ Clear error messages
- ✅ Appropriate HTTP status codes
- ✅ No technical stack traces to clients
- ✅ Validation messages actionable

---

### NFR-USE-04: API Versioning
**Category**: Usability - Evolution
**Priority**: Low

**Requirement**: The system SHOULD support API versioning to enable backwards-compatible evolution of the API.

**Rationale**:
- Prevents breaking changes for existing clients
- Enables gradual migration
- Industry best practice for public APIs

**Implementation Evidence**:
- Current: No explicit versioning (implicit v1)
- URL structure supports future versioning: `/api/v2/...`

**Measurement Criteria**:
- ⚠️ No versioning currently implemented
- ⚠️ URL structure allows future versioning
- ⚠️ Breaking changes require major version increment

**Status**: Not implemented (academic project, single version)

---

## Scalability Requirements (NFR-SCALE)

### NFR-SCALE-01: Horizontal Scalability
**Category**: Scalability - Elasticity
**Priority**: Medium

**Requirement**: The system SHOULD support horizontal scaling by running multiple instances behind a load balancer. The stateless architecture SHALL enable this without session affinity.

**Rationale**:
- Horizontal scaling more cost-effective than vertical
- Stateless JWT authentication enables load balancing
- No session sharing required

**Implementation Evidence**:
- Stateless session management: [SecurityConfig.java:102](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/SecurityConfig.java#L102)
- JWT authentication (stateless)
- No server-side session storage

**Measurement Criteria**:
- ✅ Stateless architecture
- ⚠️ No session affinity required
- ⚠️ Shared database required (H2 not suitable for multi-instance)

**Status**: Architectural support present, database limits scalability

---

### NFR-SCALE-02: Database Scalability
**Category**: Scalability - Capacity
**Priority**: Low

**Requirement**: The system SHOULD be designed to support migration from H2 to a production-grade database (PostgreSQL, MySQL) without code changes.

**Rationale**:
- H2 suitable for development, not production
- JPA abstraction enables database portability
- Production systems need robust DBMS

**Implementation Evidence**:
- JPA/Hibernate abstraction layer
- Database-agnostic queries
- Configuration-based database selection: [application.properties:22-33](Original/src/main/resources/application.properties#L22-L33)

**Measurement Criteria**:
- ✅ JPA abstraction used throughout
- ✅ No database-specific SQL
- ⚠️ Database selection via configuration
- ⚠️ Migration requires testing

**Status**: Architecturally supported, not tested with other databases

---

## Portability Requirements (NFR-PORT)

### NFR-PORT-01: Platform Independence
**Category**: Portability - Adaptability
**Priority**: High

**Requirement**: The system SHALL be platform-independent, running on any operating system that supports Java 17+.

**Rationale**:
- Java provides "write once, run anywhere"
- Enables deployment flexibility
- Reduces vendor lock-in

**Implementation Evidence**:
- Java/Jakarta EE technology stack
- Spring Boot (cross-platform)
- No OS-specific code
- Configuration uses standard paths

**Measurement Criteria**:
- ✅ Java 17+ required
- ✅ No OS-specific dependencies
- ✅ Cross-platform file paths
- ✅ Tested on Windows (project location)

---

### NFR-PORT-02: Containerization Support
**Category**: Portability - Installability
**Priority**: Low

**Requirement**: The system SHOULD be containerizable using Docker for consistent deployment across environments.

**Rationale**:
- Containers ensure consistency (dev/prod)
- Simplified deployment
- Industry standard for cloud deployment

**Implementation Evidence**:
- Executable JAR packaging (Spring Boot)
- Externalized configuration
- No dependencies on OS services

**Measurement Criteria**:
- ⚠️ No Dockerfile provided
- ✅ JAR packaging suitable for containers
- ✅ Externalized configuration

**Status**: Containerization not implemented but architecturally feasible

---

## Compliance Requirements (NFR-COMP)

### NFR-COMP-01: GDPR Compliance
**Category**: Compliance - Legal
**Priority**: High

**Requirement**: The system SHALL comply with GDPR requirements for handling personal data, including consent management, data minimization, and right to be forgotten.

**Rationale**:
- GDPR compliance is legal requirement in EU
- Protects user privacy
- Avoids regulatory penalties

**Implementation Evidence**:
- Consent fields: [ReaderDetails.java:39-50](Original/src/main/java/pt/psoft/g1/psoftg1/readermanagement/model/ReaderDetails.java#L39-L50)
  - `gdprConsent` (mandatory)
  - `marketingConsent` (optional)
  - `thirdPartySharingConsent` (optional)
- Consent validation: [ReaderDetails.java:66-68](Original/src/main/java/pt/psoft/g1/psoftg1/readermanagement/model/ReaderDetails.java#L66-L68)
  - "Readers must agree with the GDPR rules"

**Measurement Criteria**:
- ✅ Consent fields present
- ✅ GDPR consent mandatory for registration
- ✅ Optional consents for marketing and third-party
- ⚠️ Right to be forgotten not implemented
- ⚠️ Data export functionality not implemented

**Status**: Partial compliance (consent management only)

---

### NFR-COMP-02: Data Retention
**Category**: Compliance - Legal
**Priority**: Medium

**Requirement**: The system SHOULD implement data retention policies to automatically delete or archive old data according to business and legal requirements.

**Rationale**:
- Reduces storage costs
- Complies with data minimization principle
- Reduces liability

**Implementation Evidence**:
- ⚠️ No automatic data retention implemented
- ⚠️ Manual deletion possible

**Measurement Criteria**:
- ❌ No automatic archival
- ❌ No retention policies configured
- ⚠️ Manual data management required

**Status**: Not implemented (future enhancement)

---

### NFR-COMP-03: Audit Trail
**Category**: Compliance - Accountability
**Priority**: Low

**Requirement**: The system SHOULD maintain an audit trail of significant operations (create, update, delete) for accountability and forensic analysis.

**Rationale**:
- Enables investigation of data changes
- Supports compliance audits
- Provides accountability

**Implementation Evidence**:
- ⚠️ No explicit audit logging implemented
- ✅ Database timestamps on entities (implicit audit)
- ⚠️ Application logging (Spring Boot default)

**Measurement Criteria**:
- ❌ No dedicated audit table
- ❌ No change tracking
- ⚠️ Timestamps on entities

**Status**: Not implemented (future enhancement)

---

## Interoperability Requirements (NFR-INTER)

### NFR-INTER-01: REST API Standard
**Category**: Interoperability - Exchangeability
**Priority**: High

**Requirement**: The system SHALL expose a standards-compliant REST API using HTTP/HTTPS, JSON for data exchange, and OpenAPI 3.0 for documentation.

**Rationale**:
- REST and JSON are industry standards
- Enables integration with any HTTP client
- Language and platform agnostic

**Implementation Evidence**:
- REST controllers with Spring MVC
- JSON serialization (Jackson)
- OpenAPI 3.0: [application.properties:11-13](Original/src/main/resources/application.properties#L11-L13)

**Measurement Criteria**:
- ✅ REST/HTTP protocol
- ✅ JSON request/response format
- ✅ OpenAPI 3.0 specification
- ✅ Standard HTTP status codes

---

### NFR-INTER-02: External API Integration
**Category**: Interoperability - Interoperability
**Priority**: Low

**Requirement**: The system SHOULD support integration with external APIs for data enrichment and extended functionality.

**Rationale**:
- Enables system extension without internal development
- Leverages external services
- Demonstrates integration capability

**Implementation Evidence**:
- API Ninjas integration: [ApiNinjasService.java](Original/src/main/java/pt/psoft/g1/psoftg1/external/service/ApiNinjasService.java)
- Configuration: [ApiNinjasConfig.java](Original/src/main/java/pt/psoft/g1/psoftg1/configuration/ApiNinjasConfig.java)
- API key: [application.properties:74](Original/src/main/resources/application.properties#L74)

**Measurement Criteria**:
- ✅ External API service abstraction
- ✅ API key configuration
- ✅ HTTP client for external calls
- ✅ Error handling for external failures

---

### NFR-INTER-03: Client Libraries
**Category**: Interoperability - Interoperability
**Priority**: Low

**Requirement**: The system SHOULD provide Postman collections or client SDKs to facilitate API integration for developers.

**Rationale**:
- Reduces integration time
- Provides working examples
- Improves developer experience

**Implementation Evidence**:
- Postman collections: [Docs/Psoft-G1.postman_collection.json](Original/Docs/Psoft-G1.postman_collection.json)
- Postman environment: [Docs/Psoft-G1.postman_environment.json](Original/Docs/Psoft-G1.postman_environment.json)
- Additional collections: [resources/assets/](Original/src/main/resources/assets/)

**Measurement Criteria**:
- ✅ Postman collection provided
- ✅ Environment variables configured
- ✅ Example requests for all endpoints
- ⚠️ No client SDKs (acceptable for REST API)

---

## NFR Summary and Traceability

### Summary Statistics

**Total Non-Functional Requirements**: 30

**By Category (ISO/IEC 25010)**:
- Security: 7 (23%)
- Performance: 5 (17%)
- Reliability: 4 (13%)
- Maintainability: 5 (17%)
- Usability: 4 (13%)
- Scalability: 2 (7%)
- Portability: 2 (7%)
- Compliance: 3 (10%)
- Interoperability: 3 (10%)

**By Priority**:
- Critical: 4 (13%)
- High: 12 (40%)
- Medium: 9 (30%)
- Low: 5 (17%)

**Implementation Status**:
- ✅ Fully Implemented: 20 (67%)
- ⚠️ Partially Implemented: 8 (27%)
- ❌ Not Implemented: 2 (6%)

### Traceability Matrix

| NFR ID | Category | Priority | Status | Implementation Reference |
|--------|----------|----------|--------|--------------------------|
| NFR-SEC-01 | Security | Critical | ✅ Complete | SecurityConfig.java:179-191 |
| NFR-SEC-02 | Security | Critical | ✅ Complete | SecurityConfig.java:206-209 |
| NFR-SEC-03 | Security | Critical | ✅ Complete | SecurityConfig.java:110-172 |
| NFR-SEC-04 | Security | High | ✅ Complete | SecurityConfig.java:102 |
| NFR-SEC-05 | Security | High | ⚠️ Partial | Configuration-dependent |
| NFR-SEC-06 | Security | Medium | ✅ Complete | SecurityConfig.java:99 |
| NFR-SEC-07 | Security | High | ✅ Complete | Bean Validation, Domain Validation |
| NFR-PERF-01 | Performance | High | ⚠️ Partial | H2 configuration, needs testing |
| NFR-PERF-02 | Performance | Medium | ⚠️ Partial | JPA indexing, implicit |
| NFR-PERF-03 | Performance | High | ✅ Complete | @Version annotations |
| NFR-PERF-04 | Performance | High | ✅ Complete | Page.java, SearchRequest.java |
| NFR-PERF-05 | Performance | Medium | ✅ Complete | application.properties:54-71 |
| NFR-REL-01 | Reliability | Critical | ✅ Complete | JPA constraints, validation |
| NFR-REL-02 | Reliability | High | ⚠️ Partial | Spring @Transactional (implicit) |
| NFR-REL-03 | Reliability | High | ✅ Complete | GlobalExceptionHandler.java |
| NFR-REL-04 | Reliability | Medium | ⚠️ Partial | File-based H2, manual backup |
| NFR-MAINT-01 | Maintainability | High | ✅ Complete | Layered architecture, 7 modules |
| NFR-MAINT-02 | Maintainability | Medium | ⚠️ Partial | Docs present, Javadoc varies |
| NFR-MAINT-03 | Maintainability | High | ✅ Complete | DI, interfaces, 23 tests |
| NFR-MAINT-04 | Maintainability | High | ✅ Complete | application.properties, library.properties |
| NFR-MAINT-05 | Maintainability | Medium | ✅ Complete | Maven/Gradle evident |
| NFR-USE-01 | Usability | High | ✅ Complete | Swagger UI at /swagger-ui |
| NFR-USE-02 | Usability | High | ✅ Complete | RESTful design throughout |
| NFR-USE-03 | Usability | Medium | ✅ Complete | GlobalExceptionHandler.java |
| NFR-USE-04 | Usability | Low | ❌ Not Impl | No versioning (single version) |
| NFR-SCALE-01 | Scalability | Medium | ⚠️ Partial | Stateless, H2 limits scaling |
| NFR-SCALE-02 | Scalability | Low | ⚠️ Partial | JPA abstraction, untested |
| NFR-PORT-01 | Portability | High | ✅ Complete | Java 17+, cross-platform |
| NFR-PORT-02 | Portability | Low | ⚠️ Partial | JAR packaging, no Dockerfile |
| NFR-COMP-01 | Compliance | High | ⚠️ Partial | Consent management only |
| NFR-COMP-02 | Compliance | Medium | ❌ Not Impl | No retention policies |
| NFR-COMP-03 | Compliance | Low | ⚠️ Partial | Timestamps only, no audit log |
| NFR-INTER-01 | Interoperability | High | ✅ Complete | REST/JSON/OpenAPI |
| NFR-INTER-02 | Interoperability | Low | ✅ Complete | ApiNinjasService.java |
| NFR-INTER-03 | Interoperability | Low | ✅ Complete | Postman collections |

### Quality Attribute Scenarios

The following scenarios validate key non-functional requirements:

**Scenario 1: Concurrent Update (NFR-PERF-03)**
- Source: Two librarians
- Stimulus: Attempt to update the same book simultaneously
- Response: First update succeeds, second receives 409 Conflict (StaleObjectStateException)
- Measure: Zero lost updates

**Scenario 2: Authentication (NFR-SEC-01)**
- Source: Client application
- Stimulus: Login request with valid credentials
- Response: JWT token generated and returned
- Measure: Token validation < 100ms

**Scenario 3: Authorization (NFR-SEC-03)**
- Source: Reader user
- Stimulus: Attempts to create a new author (librarian-only operation)
- Response: 403 Forbidden
- Measure: 100% enforcement of role-based rules

**Scenario 4: Large Result Set (NFR-PERF-04)**
- Source: Client application
- Stimulus: Requests all books (1000+ books)
- Response: Paginated results (e.g., 20 per page)
- Measure: Response time < 500ms regardless of total count

**Scenario 5: Invalid Input (NFR-SEC-07)**
- Source: Client application
- Stimulus: Submits book with empty ISBN
- Response: 400 Bad Request with validation error message
- Measure: No invalid data persisted

---

## Recommendations

Based on the analysis, the following enhancements are recommended:

### High Priority
1. **Performance Testing**: Conduct load testing to validate NFR-PERF-01 and measure actual response times.
2. **Test Coverage**: Improve test coverage and measure it (target: 80%).
3. **HTTPS Configuration**: Document HTTPS setup for production deployments (NFR-SEC-05).

### Medium Priority
4. **Database Migration**: Test and document migration from H2 to PostgreSQL (NFR-SCALE-02).
5. **Audit Logging**: Implement audit trail for compliance (NFR-COMP-03).
6. **Data Retention**: Implement data retention policies (NFR-COMP-02).
7. **Javadoc**: Improve Javadoc coverage for public APIs (NFR-MAINT-02).

### Low Priority
8. **Containerization**: Create Dockerfile for Docker deployment (NFR-PORT-02).
9. **API Versioning**: Plan versioning strategy for future API evolution (NFR-USE-04).
10. **Right to be Forgotten**: Implement GDPR right to erasure (NFR-COMP-01).

---

## References

- [Architecturally Significant Requirements (ASRs)](ASR-ArchitecturallySignificantRequirements.md)
- [Functional Requirements](FunctionalRequirements.md)
- [ISO/IEC 25010 Quality Model](https://iso25000.com/index.php/en/iso-25000-standards/iso-25010)
- [Spring Boot Documentation](https://docs.spring.io/spring-boot/docs/current/reference/html/)
- [GDPR Compliance](https://gdpr.eu/)

---

**Document Control**
Version: 1.0
Last Updated: 2025-10-29
Status: Complete
Next Review: Upon architectural changes or new requirements
